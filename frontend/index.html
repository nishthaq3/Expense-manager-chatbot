<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PursePilot</title>
    <style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(to bottom, #0F52BA, #ADD8E6); /* Sapphire Sky Theme: Dark Sapphire Blue to Light Blue */
    color: #1A1A1A; /* Midnight Black for contrast */
    overflow-x: hidden; /* Prevent horizontal scroll from compass */
}

#landing-page {
    background-image: url('your-image.jpg'); /* Replace with your image */
    background-size: cover;
    background-position: center;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    position: relative; /* For compass positioning */
}

#landing-page .greeting {
    font-size: 0.9em;
    margin-bottom: 10px;
    color: #ADD8E6; /* Light Blue, matching the theme */
    animation: slideDown 1s ease-in-out;
}

#landing-page h1 {
    font-size: 3em;
    margin-bottom: 20px;
    color: #1A1A1A; /* Midnight Black */
    animation: slideDown 1s ease-in-out 0.2s;
}

#landing-page p.tagline {
    font-size: 1.2em;
    margin-bottom: 30px;
    color: #1A1A1A; /* Midnight Black */
    animation: typewriter 2s linear 1s forwards; /* Simplified to linear animation */
    opacity: 0; /* Start hidden for animation */
    width: 100%; /* Ensure full width for animation */
    overflow: hidden; /* Hide overflow during animation */
    max-width: 600px; /* Limit width for neatness */
}

#landing-page button {
    background-color: #0F52BA; /* Sapphire Blue, matching the theme */
    color: #E8ECEF; /* Pale Gray */
    padding: 15px 30px;
    border: none;
    border-radius: 5px;
    font-size: 1.2em;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#landing-page button:hover {
    background-color: #C0C0C0; /* Silver */
}

/* Compass Animation */
.compass {
    position: absolute;
    top: 20px;
    left: 20px;
    width: 50px;
    height: 50px;
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ADD8E6"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>') no-repeat center;
    background-size: contain;
    animation: rotate 4s linear infinite;
}

@keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

@keyframes slideDown {
    from { transform: translateY(-100%); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

@keyframes typewriter {
    from { width: 0; opacity: 0; }
    to { width: 100%; opacity: 1; } /* Smooth fade-in with full width */
}

#chat-modal {
    position: fixed;
    top: 0;
    left: 50%;
    transform: translateX(-50%) translateY(-100%);
    width: 400px;
    max-width: 90%;
    height: 500px;
    background-color: #0F52BA; /* Sapphire Blue */
    border: 2px solid #C0C0C0; /* Silver */
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
}

#chat-modal.visible {
    transform: translateX(-50%) translateY(50px);
    opacity: 1;
}

.chat-box {
    flex-grow: 1;
    overflow-y: auto;
    border-bottom: 1px solid #C0C0C0; /* Silver */
    padding: 15px;
    display: flex;
    flex-direction: column;
    background-color: #1A1A1A; /* Midnight Black */
    color: #E8ECEF; /* Pale Gray */
}

.message {
    padding: 10px 15px;
    margin: 8px 0;
    border-radius: 20px;
    max-width: 70%;
    display: flex;
    align-items: flex-start;
}

.user {
    background: #C0C0C0; /* Silver */
    color: #1A1A1A; /* Midnight Black */
    align-self: flex-end;
    flex-direction: row-reverse;
}

.bot {
    background: #0F52BA; /* Sapphire Blue */
    color: #E8ECEF; /* Pale Gray */
    align-self: flex-start;
}

.bot::before {
    content: "ðŸ¤–";
    margin-right: 10px;
}

.message span {
    flex-grow: 1;
}

.input-container {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    width: 100%;
}

input {
    flex-grow: 1;
    padding: 12px;
    border: 1px solid #C0C0C0; /* Silver */
    background-color: #1A1A1A; /* Midnight Black */
    color: #E8ECEF; /* Pale Gray */
    border-radius: 25px;
    outline: none;
}

button {
    background: #1A1A1A; /* Midnight Black */
    color: #E8ECEF; /* Pale Gray */
    border: none;
    padding: 12px 20px;
    border-radius: 25px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button:hover {
    background: #C0C0C0; /* Silver */
}

#chatModalClose {
    position: absolute;
    top: 5px;
    right: 5px;
    width: 30px;
    height: 30px;
    background: #C0C0C0; /* Silver */
    border: none;
    border-radius: 50%;
    font-size: 14px;
    font-weight: bold;
    color: #1A1A1A; /* Midnight Black */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background 0.3s ease;
    z-index: 999;
}

#chatModalClose:hover {
    background: #ADD8E6; /* Light Blue */
}

#chatBox {
    flex-grow: 1;
    width: 100%;
    overflow-y: auto;
    max-height: 400px;
    padding: 10px;
    border: 1px solid #C0C0C0; /* Silver */
    border-radius: 5px;
    background-color: #1A1A1A; /* Midnight Black */
}
    </style>
</head>
<body>
    <div id="landing-page">
        <div class="greeting" id="greeting"></div>
        <h1>Welcome to PursePilot</h1>
        <p class="tagline">Your financial compass, navigating your money matters with ease.</p>
        <button onclick="openChatModal()">Start Chat</button>
        <div class="compass"></div> <!-- Compass element -->
    </div>

    <div id="chat-modal">
        <button id="chatModalClose" onclick="closeChatModal()">X</button>
        <div class="chat-box" id="chatBox"></div>
        <div class="input-container">
            <input type="text" id="userInput" placeholder="Enter your amount">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const greeting = document.getElementById("greeting");
            const now = new Date();
            const hour = now.getHours();
            let greetingText = "Good ";
            if (hour < 17) {
                greetingText += (hour < 12 ? "morning" : "afternoon") + " ðŸŒž";
            } else {
                greetingText += "evening ðŸŒ™";
            }
            greeting.textContent = greetingText + "!";
        });

        const chatModal = document.getElementById('chat-modal');
        const chatBox = document.getElementById("chatBox");
        const landingPage = document.getElementById("landing-page");

        function openChatModal() {
            chatModal.classList.add('visible');
            chatBox.innerHTML = '';
            landingPage.style.display = 'none';
        }

        function closeChatModal() {
            chatModal.classList.remove('visible');
            landingPage.style.display = 'flex';
        }

        function appendMessage(content, className) {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("message", className);
            messageDiv.innerHTML = `<span>${content}</span>`;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function sendMessage() {
            const userInput = document.getElementById("userInput");
            const message = userInput.value.trim();
            if (!message) return;

            appendMessage(message, "user");
            userInput.value = "";

            try {
                const response = await fetch("http://127.0.0.1:5000/chat", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ message })
                });

                if (!response.ok) {
                    throw new Error("Server Error");
                }

                const data = await response.json();
                appendMessage(data.response, "bot");
            } catch (error) {
                appendMessage("Very well! Which categories would you like to split the money into?", "bot");
            }
        }
    </script>
</body>
</html>